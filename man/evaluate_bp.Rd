% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/evaluate_bp.R
\name{evaluate_bp}
\alias{evaluate_bp}
\title{评价中国3-17岁儿童青少年血压 (基于2017年国标)}
\usage{
evaluate_bp(
  data,
  sex_col = "性别",
  age_col = "年龄",
  height_col = "身高",
  sbp_col = "收缩压",
  dbp_col = "舒张压"
  language = c("chinese", "english")
)
}
\arguments{
\item{data}{一个数据框 (data.frame)，包含待评价的儿童体检数据。}

\item{sex_col}{字符串。指定性别列的名称（默认为 "性别"）。
\itemize{
\item 数据要求：必须包含 "男" 或 "女"，或可被转换为字符的标识。
}}

\item{age_col}{字符串。指定年龄列的名称（默认为 "年龄"）。
\itemize{
\item 支持格式：数值 (如 10.5)、字符串 (如 "10岁"、"120月")。
\item 范围：3岁 ~ 17岁 (不满3岁或超过18岁将返回 "无法评价")。
}}

\item{height_col}{字符串。指定身高列的名称（默认为 "身高"）。
\itemize{
\item 单位：\strong{厘米 (cm)}。需注意数据应为数值型。
}}

\item{sbp_col}{字符串。指定收缩压(高压)列的名称（默认为 "收缩压"）。
\itemize{
\item 单位：\strong{毫米汞柱 (mmHg)}。
}}

\item{dbp_col}{字符串。指定舒张压(低压)列的名称（默认为 "舒张压"）。
\itemize{
\item 单位：\strong{毫米汞柱 (mmHg)}。
}}
\item{language}{字符串。评价结果的语言，可选 \code{"chinese"}（默认）或 \code{"english"}。}
}
\value{
返回原始数据框 \code{data}，并在最后增加一列：
\item{BP_Evaluation}{字符型列，包含评价结果："正常"、"正常高值"、"1期高血压"、"2期高血压"、"缺失" 或 "无法评价(年龄/身高超出范围)"。}
}
\description{
本函数依据 2017 年发布的《中国3～17岁儿童性别、年龄别和身高别血压参照标准》，对儿童青少年的血压状况进行自动评价。
函数内置了智能解析逻辑，能够处理各种非标准化的年龄格式（如"3岁5月"），并严格按照医学标准进行身高查表和血压分级。
}
\details{
\strong{1. 智能年龄解析逻辑 (Robust Age Parsing)}
为了提高数据处理的鲁棒性，函数按以下优先级处理 \code{age_col} 列：
\itemize{
\item \strong{"岁"与"月"混用}：如 "3岁5月"，自动转换为 \eqn{3 + 5/12} 岁。
\item \strong{纯"岁"或纯"月"}：自动提取数字部分并识别单位。
\item \strong{纯数字智能推断}：
\itemize{
\item 数值 > 18：视为"月龄" (因为17岁是量表上限)，自动除以12转换为岁。
\item 数值 <= 18：视为"岁龄"。
}
\item \strong{查表标准}：计算出的年龄将\strong{向下取整} (floor) 为周岁进行查表。
}

\strong{2. 身高查表逻辑 (Height Matching)}
\itemize{
\item 依据标准，身高需精确匹配表格中的区间。
\item 函数会对输入的 \code{height_col} 进行\strong{四舍五入} (\code{floor(x + 0.5)}) 取整后，再与标准表中的身高段进行匹配。
}

\strong{3. 血压评价标准 (Evaluation Criteria)}
依据 2017 年国标及临床指南，评价结果分为以下四类：
\itemize{
\item \strong{正常 (Normal)}: SBP < P90 且 DBP < P90
\item \strong{正常高值 (High-normal)}: P90 ≤ BP < P95，或 BP ≥ 120/80 mmHg (且未达到高血压标准)
\item \strong{1期高血压 (Stage 1 Hypertension)}: P95 ≤ BP < P99 + 5 mmHg
\item \strong{2期高血压 (Stage 2 Hypertension)}: BP ≥ P99 + 5 mmHg
}
\emph{注：收缩压(SBP)和舒张压(DBP)分别评价，最终结果取两者中较严重者。}
}
\examples{
# 1. 基础用法
df_basic <- data.frame(
  性别 = c("男", "女"),
  年龄 = c(10, 12),
  身高 = c(140, 150),
  收缩压 = c(110, 130),
  舒张压 = c(70, 85)
)
# evaluate_bp(df_basic)

# 2. 处理复杂年龄格式
df_complex <- data.frame(
  sex = c("男", "男", "女"),
  age = c("75月", "3岁5月", "120"), # 分别对应：6.25岁, 3.41岁, 10岁
  ht = c(120.5, 98, 140),
  sbp = c(110, 90, 130),
  dbp = c(70, 60, 85)
)
# 指定列名进行评价
# evaluate_bp(df_complex,
#             sex_col = "sex", age_col = "age", height_col = "ht",
#             sbp_col = "sbp", dbp_col = "dbp")
}
\references{
范晖, 闫银坤, 米杰. 中国3～17岁儿童性别、年龄别和身高别血压参照标准修订[J]. 中华高血压杂志, 2017, 25(5): 428-435. DOI: 10.16439/j.cnki.1673-7245.2017.05.009
}
